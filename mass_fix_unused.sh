#!/bin/bash
echo "=== МАССОВОЕ ИСПРАВЛЕНИЕ НЕИСПОЛЬЗУЕМЫХ ПЕРЕМЕННЫХ ==="

# Счетчик исправлений
count=0

# Находим все файлы с неиспользуемыми переменными
find . -name "*.ts" -not -path "*/node_modules/*" -not -path "*/dist/*" | while read file; do
  echo "Обрабатываем файл: $file"
  
  # Исправляем const переменные (добавляем _ префикс)
  # Ищем строки вида: const variableName = 
  sed -i '' 's/const \([a-zA-Z][a-zA-Z0-9]*\) =/const _\1 =/g' "$file"
  
  # Обновляем ссылки на переменные в том же файле
  # Это упрощенная версия - в реальности нужен более сложный анализ
  
  count=$((count + 1))
  if [ $((count % 10)) -eq 0 ]; then
    echo "Обработано файлов: $count"
  fi
done

echo "Исправление завершено! Обработано файлов: $count"
